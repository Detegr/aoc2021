# star 1

Split â† (âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢
RemoveTrailing â† (âˆ¨`âˆ§âˆ¨âŸœÂ«)âˆ˜â‰ /âŠ¢

data â† â€¢FLines "inputs/input4"
numbers â† â€¢BQNÂ¨','SplitâŠ‘data
# Convert tables from input data to 3xmxn matrix
tables â† >>Â¨â€¢BQNâš‡1' 'âŠ¸Splitâˆ˜(' 'âŠ¸RemoveTrailing)âš‡1 1â†“Â¨1â†“((+`Â¬âˆ˜(0âŠ¸â‰ (â‰ âŠ¢)Â¨))âŠ”âŠ¢) 1â†“data
# All possible rows that are winning
winningrows â† â¥Š{(<Ë˜â‰ğ•©)âˆ¾<Ë˜ğ•©}Ë˜tables
# Prefixes of numbers (quite expensive, but whatever)
numberseq â† â†‘numbers
iâ†0 â‹„ w â† 1âŠ‘â‰¢tables
# Iterate over number prefixes until a prefix matches a winning row
winâ†âŠ‘{iâ†©i+1 â‹„ ğ•©â†©/{w=(+Â´ğ•©âˆŠ(iâŠ‘numberseq))}Â¨winningrows}â€¢_while_(â‰ =âŸœ0âŠ¢) âŸ¨âŸ©
tableNumberCount â† +Â´1â†“â‰¢tables
# Dig out the table that won the bingo
wintable â† â¥Š(âŒŠwinÃ·tableNumberCount)âŠtables
# Table that won with used numbers removed
rest â† (Â¬âˆ˜âˆŠâŸœ(iâŠ‘numberseq)/âŠ¢) wintable
# Calculate the final score
Â¯1âŠ‘iâŠ‘numberseq Ã— +Â´rest

# star 2
iâ†©0
# calculate winning rows for every possible prefix of the number input
# again, horribly expensive but whatever
all â† {ğ•©â†©/{w=(+Â´ğ•©âˆŠ(iâŠ‘numberseq))}Â¨winningrows â‹„ iâ†©i+1 â‹„ ğ•©}Â¨numberseq
# The index of the round that had the last win
i â†© âŠ‘/{(â‰ ğ•©) = âŠ‘â‰¢tables}Â¨â·Â¨{âŒŠğ•©Ã·tableNumberCount}Â¨all
# The number that won
win â†© Â¯1âŠ‘iâŠ‘numberseq
# The winning table
wintable â†© â¥Š(âŒŠiÃ·tableNumberCount)âŠtables
# Table that won with used numbers removed
rest â†© (Â¬âˆ˜âˆŠâŸœ(iâŠ‘numberseq)/âŠ¢) wintable
# Calculate the final score
Â¯1âŠ‘iâŠ‘numberseq Ã— +Â´rest
